/* Generated from schema\oc2slpf-v1.0.jadn, Tue Oct 22 14:13:44 2019 */

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://oasis-open.org/openc2/oc2slpf/v1.0",
  "title": "Stateless Packet Filtering",
  "description": "Data definitions for Stateless Packet Filtering (SLPF) functions",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "target": {
      "$ref": "#/definitions/Target"
    },
    "specifiers": {
      "$ref": "#/definitions/Specifiers"
    },
    "args": {
      "$ref": "#/definitions/Args"
    }
  },
  "definitions": {
    "Target": {
      "title": "Target",
      "type": "object",
      "description": "SLPF targets",
      "additionalProperties": false,
      "minProperties": 1,
      "maxProperties": 1,
      "properties": {
        "rule_number": {
          "$ref": "#/definitions/Rule-ID",
          "description": "Immutable identifier assigned when a rule is created. Identifies a rule to be deleted"
        }
      }
    },
    "Specifiers": {
      "title": "Specifiers",
      "type": "object",
      "description": "SLPF actuator specifiers",
      "additionalProperties": false,
      "properties": {
        "hostname": {
          "type": "string",
          "description": "RFC 1123 hostname (can be a domain name or IP address) for a particular device with SLPF functionality"
        },
        "named_group": {
          "type": "string",
          "description": "User defined collection of devices with SLPF functionality"
        },
        "asset_id": {
          "type": "string",
          "description": "Unique identifier for a particular SLPF"
        },
        "asset_tuple": {
          "type": "array",
          "description": "Unique tuple identifier for a particular SLPF consisting of a list of up to 10 strings",
          "minItems": 1,
          "maxItems": 10,
          "items": {
            "type": "string",
            "description": "Unique tuple identifier for a particular SLPF consisting of a list of up to 10 strings"
          }
        }
      }
    },
    "Args": {
      "title": "Args",
      "type": "object",
      "description": "SLPF command arguments",
      "additionalProperties": false,
      "properties": {
        "drop_process": {
          "$ref": "#/definitions/Drop-Process",
          "description": "Specifies how to handle denied packets"
        },
        "persistent": {
          "type": "boolean",
          "description": "Normal operations assume any changes to a device are to be implemented persistently. Setting the persistent modifier to FALSE results in a change that is not persistent in the event of a reboot or restart"
        },
        "direction": {
          "$ref": "#/definitions/Direction",
          "description": "Specifies whether to apply rules to incoming or outgoing traffic. If omitted, rules are applied to both"
        },
        "insert_rule": {
          "$ref": "#/definitions/Rule-ID",
          "description": "Specifies the identifier of the rule within a list, typically used in a top-down rule list"
        }
      }
    },
    "Drop-Process": {
      "title": "Drop Process",
      "type": "string",
      "oneOf": [
        {
          "const": "none",
          "description": "Drop the packet and do not send a notification to the source of the packet"
        },
        {
          "const": "reject",
          "description": "Drop the packet and send an ICMP host unreachable (or equivalent) to the source of the packet"
        },
        {
          "const": "false_ack",
          "description": "Drop the traffic and send a false acknowledgment"
        }
      ]
    },
    "Direction": {
      "title": "Direction",
      "type": "string",
      "oneOf": [
        {
          "const": "both",
          "description": "Apply rules to all traffic"
        },
        {
          "const": "ingress",
          "description": "Apply rules to incoming traffic only"
        },
        {
          "const": "egress",
          "description": "Apply rules to outgoing traffic only"
        }
      ]
    },
    "Rule-ID": {
      "title": "Rule ID",
      "type": "integer",
      "description": "Access rule identifier"
    },
    "OpenC2-Response": {
      "title": "OpenC2 Response",
      "type": "object",
      "description": "SLPF results",
      "additionalProperties": false,
      "properties": {
        "rule_number": {
          "$ref": "#/definitions/Rule-ID",
          "description": "Rule identifier returned from allow or deny Command."
        }
      }
    }
  }
}